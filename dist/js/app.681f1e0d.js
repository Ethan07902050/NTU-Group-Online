(function(e){function t(t){for(var n,a,c=t[0],l=t[1],s=t[2],u=0,d=[];u<c.length;u++)a=c[u],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&d.push(r[a][0]),r[a]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);m&&m(t);while(d.length)d.shift()();return i.push.apply(i,s||[]),o()}function o(){for(var e,t=0;t<i.length;t++){for(var o=i[t],n=!0,a=1;a<o.length;a++){var l=o[a];0!==r[l]&&(n=!1)}n&&(i.splice(t--,1),e=c(c.s=o[0]))}return e}var n={},r={app:0},i=[];function a(e){return c.p+"js/"+({about:"about"}[e]||e)+"."+{about:"e0c8357b"}[e]+".js"}function c(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,c),o.l=!0,o.exports}c.e=function(e){var t=[],o=r[e];if(0!==o)if(o)t.push(o[2]);else{var n=new Promise((function(t,n){o=r[e]=[t,n]}));t.push(o[2]=n);var i,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=a(e);var s=new Error;i=function(t){l.onerror=l.onload=null,clearTimeout(u);var o=r[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+n+": "+i+")",s.name="ChunkLoadError",s.type=n,s.request=i,o[1](s)}r[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:l})}),12e4);l.onerror=l.onload=i,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,o){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(c.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(o,n,function(t){return e[t]}.bind(null,n));return o},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var m=s;i.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},1334:function(e,t,o){"use strict";o("cea6")},"155e":function(e,t,o){},"1bed":function(e,t,o){},"32b9":function(e,t,o){"use strict";var n=o("d4ec"),r=o("4360"),i=o("1232"),a="ws://ntu-online-group-ws.herokuapp.com",c=a+"/wsServer/connection/user/",l=a+"/ws/room/",s=function e(t,o,r){Object(n["a"])(this,e),this.websocket=t,this.userID=o,this.token=r},u=function e(t,o,r,i){Object(n["a"])(this,e),this.websocket=t,this.userID=o,this.roomID=r,this.token=i};t["a"]={InitNotifyWebsocket:function(e){var t=Object(i["a"])(e);r["a"].state.user_id=t.user_id;var o=t.user_id,n=new WebSocket(c+o);return n.onopen=function(){var t={user_id:o,token:e};n.send(JSON.stringify(t));var i=new s(n,r["a"].state.user_id,e);r["a"].state.notifyWebsocketConn=i},n.onclose=function(){console.log("Notification websocket close")},n},InitRoomWebsocket:function(e,t){var o=Object(i["a"])(e),n=o.user_id,a=new WebSocket(l+t);return a.onopen=function(){var o={user_id:n,token:e};a.send(JSON.stringify(o));var i=new u(a,n,t,e);r["a"].state.roomWebsocketConn[t]=i},a.onclose=function(){console.log("Room ID: "+t+" websocket close")},a}}},"37ae":function(e,t,o){},"3aea":function(e,t,o){"use strict";var n=o("2909"),r=o("ade3"),i=(o("d3b7"),o("d81d"),o("b64b"),o("99af"),o("25f0"),o("fb6a"),o("bc3a")),a=o.n(i),c=o("4360"),l=o("a18c");a.a.defaults.xsrfCookieName="csrftoken",a.a.defaults.xsrfHeaderName="X-CSRFToken";var s=a.a.create({baseURL:"https://ntu-online-group-api.herokuapp.com/",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}});s.interceptors.request.use((function(e){var t=c["a"].state.token;return t&&(e.headers.Authorization="Bearer "+t),e}),(function(e){return Promise.reject(e)})),s.interceptors.response.use((function(e){return Promise.resolve(e)}),(function(e){if(e&&e.response)switch(e.response.status){case 401:console.log("登入無效"),c["a"].dispatch("logout"),l["a"].push("/");break;case 404:console.log("找不到該頁面");break;case 500:console.log("伺服器出錯");break;case 503:console.log("服務失效");break;default:console.log("連接錯誤".concat(e.response.status))}else console.log("連接到服務器失敗");return Promise.reject(e.response)})),t["a"]={renameKeys:function(e,t){var o=Object.keys(e).map((function(o){var n=t[o]||o;return Object(r["a"])({},n,e[o])}));return Object.assign.apply(Object,[{}].concat(Object(n["a"])(o)))},getRooms:function(){return s.get("/room/")},postRoom:function(e){console.log("[Room]:",e.date2.toString());var t={description:"introduction",type:"room_type",capacity:"people_limit",category:"room_category"},o=this.renameKeys(e,t);return o["valid_time"]=e.date1.getFullYear()+"-"+(e.date1.getMonth()+1)+"-"+e.date1.getDate()+" "+e.date2.toString().slice(16,24),console.log("[renamedRoom]:",o),s.post("/room/",o)},getRoom:function(e){return s.get("/room/"+e+"/")},putRoom:function(e,t){return s.put("/room/"+e+"/",t)},getRoomMemberList:function(e){return s.get("/room/"+e+"/member_list/")},getRoomBlockList:function(e){return s.get("/room/"+e+"/block_list/")},postJoinRoom:function(e,t){return s.post("/room/"+e+"/join_room/",{nickname:t})},deleteLeaveRoom:function(e){return s.delete("room/"+e+"/leave_room/")},deleteRoom:function(e){return s.delete("room/"+e+"/")},getRoomCategory:function(){return s.get("/room/category_list/")},getRoomType:function(){return s.get("/room/type_list/")},postBlockUser:function(e,t,o){return s.post("/room/"+e+"/block/"+t+"/",{reason:o})},deleteUnblockUser:function(e,t){return s.delete("/room/"+e+"/unblock/"+t+"/")},deleteRemoveUser:function(e,t,o){return s.delete("/room/"+e+"/remove/"+t+"/",{reason:o})},putTransferAdmin:function(e,t){return s.put("/room/"+e+"/transfer_admin/"+t+"/")},putSetLevel:function(e,t){return s.put("/room/"+e+"/set_access_level/",t)},getRoomInvitationList:function(e){return s.get("/room/"+e+"/invitation/")},postRoomInvite:function(e,t){return s.post("/room/"+e+"/invite/"+t+"/")},getRoomRecord:function(e){return s.get("/room_record/"+e+"/")},getUserId:function(){return s.get("/api/user/get_id/")},getUserDetail:function(e){return s.get("/api/user/"+e+"/")},getUserRooms:function(){return s.get("/user_room/")},getMailVerify:function(e,t){return s.get("/api/user/verify_email/"+e+"/"+t+"/")},postResetPassword:function(e,t,o){return s.post("/api/user/password_reset/"+e+"/"+t+"/",{password:o})},postRegister:function(e){return s.post("/api/user/register/",e)}}},"3d22":function(e,t,o){},"3d9b":function(e,t,o){},4360:function(e,t,o){"use strict";var n=o("1da1"),r=(o("d3b7"),o("96cf"),o("5502")),i=o("bc3a"),a=o.n(i),c=o("a18c");a.a.defaults.xsrfCookieName="csrftoken",a.a.defaults.xsrfHeaderName="X-CSRFToken";var l=a.a.create({baseURL:"http://localhost:8000",withCredentials:!1,headers:{Accept:"application/json","Content-Type":"application/json"}});l.interceptors.request.use((function(e){var t=m.state.token;return t&&(e.headers.Authorization="Bearer "+t),e}),(function(e){return Promise.reject(e)})),l.interceptors.response.use((function(e){return Promise.resolve(e)}),(function(e){if(e&&e.response)switch(e.response.status){case 401:console.log("登入無效"),m.dispatch("logout"),c["a"].push("/");break;case 404:console.log("找不到該頁面");break;case 500:console.log("伺服器出錯");break;case 503:console.log("服務失效");break;default:console.log("連接錯誤".concat(e.response.status))}else console.log("連接到服務器失敗");return Promise.reject(e.response)}));var s={postLogin:function(e){return l.post("/token/",{email:e["email"],password:e["password"]})},postVerifyToken:function(e){return l.post("/token/verify/",e)},postRefreshToken:function(e){return l.post("/token/refresh/",e)},getRoom:function(e){return l.get("/rooms/"+e)},postRoom:function(e){return l.post("/rooms",e)}},u=o("3aea"),m=t["a"]=Object(r["a"])({state:{filter:"",roomWebsocketConn:{},notifyWebsocketConn:null,user_id:-1,is_verify:null,first_connect:!0,token:localStorage.getItem("token")||"",refreshToken:localStorage.getItem("refresh_token")||""},mutations:{SET_TOKEN:function(e,t){"access"in t&&(e.token=t["access"],localStorage.setItem("token",t["access"])),"refresh"in t&&(e.refreshToken=t["refresh"],localStorage.setItem("refresh_token",t["refresh"]))},SET_VERIFY:function(e,t){e.is_verify=t},SET_UID:function(e,t){e.user_id=t}},actions:{login:function(e,t){var o=e.commit;return s.postLogin(t).then((function(e){200==e.status&&o("SET_TOKEN",e.data)}))},logout:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.dispatch,localStorage.removeItem("token"),localStorage.removeItem("refresh_token"),t.next=5,o("resetToken");case 5:return console.log("complete logout"),t.abrupt("return","success");case 7:case"end":return t.stop()}}),t)})))()},verifyToken:function(){return s.postVerifyToken({token:this.state.token})},refreshToken:function(e){var t=e.commit;return s.postRefreshToken({refresh:this.state.refreshToken||"invalid_refresh_token_setting_for"}).then((function(e){if(200==e.status)return t("SET_TOKEN",e.data),localStorage.setItem("token",e.data["access"]),Promise.resolve(e);console.log("[Action refreshToken]: 理論上不會出現這行",e)}))},resetToken:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.commit,t.next=3,o("SET_TOKEN",{access:"",refresh:""});case 3:localStorage.removeItem("token"),localStorage.removeItem("refresh_token");case 5:case"end":return t.stop()}}),t)})))()},getIsVerify:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.commit,n=-1,t.next=4,u["a"].getUserId().then((function(e){return n=e.data.id,u["a"].getUserDetail(n)})).then((function(e){1==e.data.is_verify?o("SET_VERIFY",!0):o("SET_VERIFY",!1)})).catch((function(e){console.log("[store.getIsVerify err]:",e)}));case 4:case"end":return t.stop()}}),t)})))()},getUserId:function(e){return Object(n["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.commit,t.next=3,u["a"].getUserId().then((function(e){o("SET_UID",e.data.id)})).catch((function(e){console.log("[store.getUserId err]:",e)}));case 3:case"end":return t.stop()}}),t)})))()}},getters:{getToken:function(e){return e.token},isAuth:function(e){return!!e.token}},modules:{}})},"469f":function(e,t,o){"use strict";o("5cc0")},"4b43":function(e,t,o){"use strict";o("3d22")},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d"),o("159b"),o("d3b7"),o("ddb0"),o("ac1f"),o("5319");var n=o("8103"),r=o.n(n),i=o("bba4"),a=o.n(i),c=o("7a23"),l={id:"app"};function s(e,t,o,n,r,i){var a=Object(c["M"])("NavBar"),s=Object(c["M"])("router-view");return Object(c["D"])(),Object(c["i"])("div",l,[Object(c["m"])(a,{onLogoutsignal:i.logouthandle},null,8,["onLogoutsignal"]),Object(c["m"])(s,{key:e.$route.fullPath,onWsConnStart:i.initWs},null,8,["onWsConnStart"])])}var u=o("5530"),m=(o("841c"),Object(c["fb"])("data-v-2ada9471"));Object(c["G"])("data-v-2ada9471");var d={id:"nav",class:"nav"},b={class:"menu-item-group left-group"},f=Object(c["l"])("Homepage"),p=Object(c["m"])("i",{class:"el-icon-plus"},null,-1),g=Object(c["m"])("i",{class:"el-icon-bell"},null,-1),h=Object(c["l"])(" About "),j=Object(c["l"])(" Login "),O=Object(c["l"])(" Logout "),v=Object(c["l"])(" Register "),_=Object(c["l"])(" User "),y={class:"menu-item-group right-group"},k=Object(c["m"])("i",{class:"el-icon-search"},null,-1);Object(c["E"])();var w=m((function(e,t,o,n,r,i){var a=Object(c["M"])("el-menu-item"),l=Object(c["M"])("el-input"),s=Object(c["M"])("el-menu");return Object(c["D"])(),Object(c["i"])("div",d,[Object(c["m"])(s,{"default-active":e.$route.path,class:"el-menu-nav",mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:""},{default:m((function(){return[Object(c["m"])("div",b,[Object(c["m"])(a,{route:"/",index:"/",onClick:i.clearFilter},{default:m((function(){return[f]})),_:1},8,["onClick"]),Object(c["m"])(a,{class:"plus",route:"/room/create",index:"/room/create"},{default:m((function(){return[p]})),_:1}),Object(c["m"])(a,{class:"bell",index:"5"},{default:m((function(){return[g]})),_:1}),Object(c["m"])(a,{route:"/about",index:"/about"},{default:m((function(){return[h]})),_:1}),e.isAuth?Object(c["j"])("",!0):(Object(c["D"])(),Object(c["i"])(a,{key:0,route:"/login",index:"/login"},{default:m((function(){return[j]})),_:1})),Object(c["m"])(a,{onClick:i.logout},{default:m((function(){return[O]})),_:1},8,["onClick"]),e.isAuth?Object(c["j"])("",!0):(Object(c["D"])(),Object(c["i"])(a,{key:1,route:"/register",index:"/register"},{default:m((function(){return[v]})),_:1})),Object(c["m"])(a,{route:"/profile",index:"/profile"},{default:m((function(){return[_]})),_:1})]),Object(c["m"])("div",y,[Object(c["m"])(a,{class:"searchbar",index:"/"},{default:m((function(){return[Object(c["m"])(l,{placeholder:"搜尋",modelValue:r.searchInput,"onUpdate:modelValue":t[1]||(t[1]=function(e){return r.searchInput=e}),onKeydown:i.search},null,8,["modelValue","onKeydown"])]})),_:1}),Object(c["m"])(a,{class:"search",index:"/",onClick:i.applyFilter},{default:m((function(){return[k]})),_:1},8,["onClick"])])]})),_:1},8,["default-active"])])})),R=(o("4de4"),o("5502")),V={data:function(){return{searchInput:""}},watch:{},created:function(){},computed:Object(u["a"])({},Object(R["b"])(["isAuth"])),methods:{logout:function(){var e=this;this.$store.dispatch("logout",{}).then((function(){e.$router.push({name:"home"})})).catch((function(){console.log("There was a problem when logout")})),this.$emit("logoutsignal",!0)},clearFilter:function(){this.$store.state.filter=""},search:function(e){"Enter"==e.key&&this.applyFilter()},applyFilter:function(){this.searchInput&&(this.$store.state.filter=this.searchInput,this.searchInput="")}}};o("acb1");V.render=w,V.__scopeId="data-v-2ada9471";var x=V,$=o("32b9"),M={components:{NavBar:x},data:function(){return{textarea:"",hasInitWs:!1,notifyws:null}},created:function(){var e=this;this.textarea="",this.$store.state.token&&!1===this.hasInitWs&&(this.hasInitWs=!0,this.notifyws=$["a"].InitNotifyWebsocket(this.$store.state.token),this.notifyws.onmessage=function(e){console.log(e.data);var t=JSON.parse(e.data);switch(console.log(t),t.header){case"setConn":"Success Connect"!=t.res&&console.log("Authentication Error or Websocket server Error");break;case"notify":console.log(t.notify_string),"notify"===t.notify_string&&console.log("You have notify");break;case"ping":break}}),this.$store.state.token&&this.$store.dispatch("getIsVerify").then((function(){console.log("is_verify:",e.$store.state.is_verify)}))},watch:{roomWebsocketConn:function(e){this.textarea=e}},computed:Object(u["a"])({},Object(R["c"])(["token","roomWebsocketConn"])),methods:{copyClipboard:function(){var e=document.body.appendChild(document.createElement("input"));e.setAttribute("value",this.textarea),e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),console.log(this.textarea)},testReturn:function(){var e=this.testAPI();console.log("in testReturn :",e,this.consoleText)},testAPI:function(){this.$store.dispatch("verifyToken",this.event).then((function(e){return console.log("[App.vue] testAPI, then:",e,e.data),e})).catch((function(e){return console.log("[App.vue] testAPI, catch: There was a problem in test API"),console.log(e.response.data),e.response.data}))},initWs:function(e){console.log("emit"),!0===e&&!1===this.hasInitWs&&(this.hasInitWs=!0,this.$store.state.token&&null==this.notifyws&&(console.log("initiate"),this.notifyws=$["a"].InitNotifyWebsocket(this.$store.state.token),this.notifyws.onmessage=function(e){console.log(e.data);var t=JSON.parse(e.data);switch(console.log(t),t.header){case"setConn":"Success Connect"!=t.res&&console.log("Authentication Error or Websocket server Error");break;case"notify":console.log(t.notify_string),"notify"===t.notify_string&&console.log("You have notify");break;case"ping":break}}))},logouthandle:function(){this.hasInitWs=!1,console.log("websocket close"),null!=this.notifyws&&(this.notifyws.close(),this.notifyws=null)}}};o("71f7");M.render=s;var C=M,I=o("a18c"),L=o("4360"),S=o("3fd4"),D=(o("7dd6"),o("1fa0")),T=o("14b7");console.log("https://ntu-online-group-api.herokuapp.com/");var U=Object(c["h"])(C),F=Object(T["a"])();U.config.globalProperties.emitter=F,U.use(L["a"]).use(I["a"]).use(S["a"]).use(D["a"]).mount("#app");var E=o("ef13");E.keys().forEach((function(e){var t=E(e),o=r()(a()(e.replace(/^\.\/(.*)\.\w+$/,"$1")));U.component(o,t.default||t)}))},"5cc0":function(e,t,o){},"668f":function(e,t,o){"use strict";o("155e")},"71f7":function(e,t,o){"use strict";o("7960")},"73eb":function(e,t,o){"use strict";o("3d9b")},"77b6":function(e,t,o){"use strict";o("1bed")},"77ed":function(e,t,o){"use strict";o("37ae")},7960:function(e,t,o){},"8bd8":function(e,t,o){"use strict";o("a01d")},a01d:function(e,t,o){},a18c:function(e,t,o){"use strict";o("d3b7"),o("3ca3"),o("ddb0");var n=o("6c02"),r=(o("d81d"),o("25f0"),o("7a23")),i=Object(r["fb"])("data-v-139dc7c4");Object(r["G"])("data-v-139dc7c4");var a={class:"home"},c={key:0,"transition-duration":"0.2s","item-selector":".item","column-width":".item",class:"rooms-container"},l={key:1},s={class:"dialog-footer"},u=Object(r["l"])("取 消"),m=Object(r["l"])("送出");Object(r["E"])();var d=i((function(e,t,o,n,d,b){var f=Object(r["M"])("SideBar"),p=Object(r["M"])("el-aside"),g=Object(r["M"])("RoomCard"),h=Object(r["M"])("el-empty"),j=Object(r["M"])("el-main"),O=Object(r["M"])("el-container"),v=Object(r["M"])("el-form-item"),_=Object(r["M"])("el-tag"),y=Object(r["M"])("el-input"),k=Object(r["M"])("el-form"),w=Object(r["M"])("el-button"),R=Object(r["M"])("el-dialog"),V=Object(r["N"])("masonry-tile"),x=Object(r["N"])("masonry");return Object(r["D"])(),Object(r["i"])("div",a,[Object(r["m"])(O,null,{default:i((function(){return[Object(r["m"])(p,{width:"160px"},{default:i((function(){return[Object(r["m"])(f,{onApplyFilter:t[1]||(t[1]=function(e){return b.updateFilter(e)}),sideBarList:d.sideBarList.map((function(e){return{text:e,url:""}})),urlMode:!1},null,8,["sideBarList"])]})),_:1}),Object(r["m"])(j,{id:"roomCardContainer"},{default:i((function(){return[b.filteredRooms.length>0?Object(r["cb"])((Object(r["D"])(),Object(r["i"])("div",c,[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(b.filteredRooms,(function(e,t){return Object(r["cb"])((Object(r["D"])(),Object(r["i"])("div",{class:"item",key:t},[Object(r["m"])(g,{room:e,typeDict:d.roomTypeDict,onUpdate:b.updateClickedRoom,imageList:d.imageList},null,8,["room","typeDict","onUpdate","imageList"])],512)),[[V]])})),128))],512)),[[x]]):(Object(r["D"])(),Object(r["i"])("div",l,[Object(r["m"])(h,{description:"找不到相關結果"})]))]})),_:1})]})),_:1}),Object(r["m"])(R,{title:"加入房間",modelValue:d.dialogFormVisible,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d.dialogFormVisible=e})},{footer:i((function(){return[Object(r["m"])("span",s,[Object(r["m"])(w,{onClick:t[3]||(t[3]=function(e){return d.dialogFormVisible=!1})},{default:i((function(){return[u]})),_:1}),Object(r["m"])(w,{type:"primary",onClick:b.joinRoom},{default:i((function(){return[m]})),_:1},8,["onClick"])])]})),default:i((function(){return[Object(r["m"])(k,{model:d.dialogFormRoom,"label-position":"left"},{default:i((function(){return[Object(r["m"])(v,{label:"房間名稱","label-width":d.formLabelWidth},{default:i((function(){return[Object(r["m"])(v,{label:d.dialogFormRoom.title},null,8,["label"])]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"房間 Type","label-width":d.formLabelWidth},{default:i((function(){return[Object(r["m"])(_,{type:"info"},{default:i((function(){return[Object(r["l"])(Object(r["Q"])(d.dialogFormRoom.room_type),1)]})),_:1})]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"房間 Category","label-width":d.formLabelWidth},{default:i((function(){return[Object(r["m"])(_,{type:"success",style:{"text-align":"left"}},{default:i((function(){return[Object(r["l"])(Object(r["Q"])(d.dialogFormRoom.room_category),1)]})),_:1})]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"簡介","label-width":d.formLabelWidth,class:"desc"},{default:i((function(){return[Object(r["m"])(v,{label:d.dialogFormRoom.introduction},null,8,["label"])]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"最大人數","label-width":d.formLabelWidth},{default:i((function(){return[Object(r["m"])(v,{label:d.dialogFormRoom.people_limit.toString()},null,8,["label"])]})),_:1},8,["label-width"]),Object(r["m"])(v,{label:"您的暱稱","label-width":d.formLabelWidth},{default:i((function(){return[Object(r["m"])(y,{modelValue:d.user.nickname,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d.user.nickname=e}),autocomplete:"off",clearable:"",placeholder:"請輸入暱稱"},null,8,["modelValue"])]})),_:1},8,["label-width"])]})),_:1},8,["model"])]})),_:1},8,["modelValue"])])})),b=o("5530"),f=(o("4de4"),o("caad"),o("2532"),Object(r["fb"])("data-v-0591ce70"));Object(r["G"])("data-v-0591ce70");var p=Object(r["m"])("p",null,"分類 :",-1),g={style:{"text-align":"center"}},h=Object(r["l"])("進入房間");Object(r["E"])();var j=f((function(e,t,o,n,i,a){var c=Object(r["M"])("el-skeleton-item"),l=Object(r["M"])("el-skeleton"),s=Object(r["M"])("el-tag"),u=Object(r["M"])("el-button"),m=Object(r["M"])("el-card");return Object(r["D"])(),Object(r["i"])(m,{"body-style":{padding:"0px"}},{default:f((function(){return[o.room.image_url&&!i.imageLoadFailed?(Object(r["D"])(),Object(r["i"])("img",{key:0,src:o.room.image_url,class:"image",onError:t[1]||(t[1]=function(e){return i.imageLoadFailed=!0})},null,40,["src"])):(Object(r["D"])(),Object(r["i"])(l,{key:1},{template:f((function(){return[Object(r["m"])(c,{variant:"image",style:{height:"150px"}})]})),_:1})),Object(r["m"])("h4",null,Object(r["Q"])(o.room.title),1),Object(r["m"])("div",null,[p,Object(r["m"])(s,{type:"success"},{default:f((function(){return[Object(r["l"])(Object(r["Q"])(a.getCategoryName()),1)]})),_:1}),Object(r["m"])(s,{type:"info"},{default:f((function(){return[Object(r["l"])(Object(r["Q"])(o.typeDict[o.room.room_type]?o.typeDict[o.room.room_type]:o.room.room_type),1)]})),_:1})]),Object(r["m"])("div",null,[Object(r["m"])("p",null,"人數限制 : "+Object(r["Q"])(o.room.people_limit),1),Object(r["m"])("p",null,"簡介 : "+Object(r["Q"])(a.introduction),1),Object(r["m"])("div",g,[Object(r["m"])(u,{type:"text",onClick:a.emitParent},{default:f((function(){return[h]})),_:1},8,["onClick"])])])]})),_:1})})),O=(o("fb6a"),o("7db0"),{props:{room:Object,typeDict:Object,imageList:Array},computed:{introduction:function(){return this.room.introduction.length>30?this.room.introduction.slice(0,30)+"...":this.room.introduction}},data:function(){return{images:["https://i.imgur.com/kN4J0UL.jpg","","https://i.imgur.com/17SSeJb.png","https://i.imgur.com/85zF3RK.jpg","https://i.imgur.com/o2uS5WX.png","https://i.imgur.com/wc0HqRT.png","https://i.imgur.com/qdIZSWc.jpg","https://i.imgur.com/GOaM9dB.jpg","https://i.imgur.com/G65qPbl.jpg","https://i.imgur.com/WxiJ6K0.jpg"],dialogFormVisible:!1,imageLoadFailed:!1}},methods:{emitParent:function(){this.$emit("update",{dialogFormRoom:this.room,dialogFormVisible:!0,clickedRoomId:this.room.id})},getCategoryName:function(){var e=this,t=this.imageList.find((function(t){return t.category==e.room.room_category}));return t?t.value:this.room.room_category}},watch:{dialogFormRoom:{handler:function(e){this.$emit("update",{dialogFormRoom:e,dialogFormVisible:!0}),this.dialogFormRoom=""}}}});o("cf76");O.render=j,O.__scopeId="data-v-0591ce70";var v=O,_=Object(r["m"])("i",{class:"el-icon-menu"},null,-1),y=Object(r["m"])("i",{class:"el-icon-menu"},null,-1);function k(e,t,o,n,i,a){var c=Object(r["M"])("el-menu-item"),l=Object(r["M"])("el-menu"),s=Object(r["M"])("el-scrollbar");return o.urlMode?(Object(r["D"])(),Object(r["i"])(l,{key:0,"default-active":e.$route.path,class:"SideBar",router:""},{default:Object(r["bb"])((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(o.sideBarList,(function(e,t){return Object(r["D"])(),Object(r["i"])(c,{key:t,index:e.url,route:e.url},{default:Object(r["bb"])((function(){return[_,Object(r["m"])("span",null,Object(r["Q"])(e.text),1)]})),_:2},1032,["index","route"])})),128))]})),_:1},8,["default-active"])):(Object(r["D"])(),Object(r["i"])(l,{key:1,class:"SideBar"},{default:Object(r["bb"])((function(){return[Object(r["m"])(s,null,{default:Object(r["bb"])((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(o.sideBarList,(function(e,t){return Object(r["D"])(),Object(r["i"])(c,{key:t,index:t.toString(),onClick:function(t){return a.applyFilter(e)}},{default:Object(r["bb"])((function(){return[y,Object(r["m"])("span",null,Object(r["Q"])(e.text),1)]})),_:2},1032,["index","onClick"])})),128))]})),_:1})]})),_:1}))}var w={props:["sideBarList","urlMode"],methods:{applyFilter:function(e){this.$store.state.filter!==e.text?this.$store.state.filter=e.text:this.$store.state.filter=""}}};o("668f");w.render=k;var R=w,V=o("3aea"),x=o("5502"),$={components:{RoomCard:v,SideBar:R},data:function(){var e=[{value:"自定義",url:"",category:""},{value:"課程討論",url:"https://i.imgur.com/GIiSOLM.jpg",category:"course"},{value:"吃飯",url:"https://i.imgur.com/kN4J0UL.jpg",category:"eating"},{value:"爬山",url:"https://i.imgur.com/17SSeJb.png",category:"hiking"},{value:"打籃球",url:"https://i.imgur.com/o2uS5WX.png",category:"baseketball"},{value:"打 Apex",url:"https://i.imgur.com/PkZu9rV.jpg",category:"apex"},{value:"玩 Switch 遊戲",url:"https://i.imgur.com/16C4zzd.png",category:"switch"},{value:"跑步",url:"https://i.imgur.com/wc0HqRT.png",category:"running"},{value:"團購",url:"https://i.imgur.com/hcP3JA2.png",category:"group_buying"},{value:"逛街",url:"https://i.imgur.com/85zF3RK.jpg",category:"shopping"},{value:"打遊戲",url:"https://i.imgur.com/ex5uIMF.jpg",category:"game"},{value:"買衣服",url:"https://i.imgur.com/UElotjt.jpg",category:"clothing"},{value:"麥當勞",url:"https://i.imgur.com/Ll9w1eq.png",category:"mc"},{value:"肯德基",url:"https://i.imgur.com/NBt3Xka.jpg",category:"kfc"},{value:"看電影",url:"https://i.imgur.com/QzZKggo.png",category:"moive"},{value:"演唱會",url:"https://i.imgur.com/NBt3Xka.jpg",category:"live"},{value:"打桌球",url:"https://i.imgur.com/kluQV3e.jpg",category:"tabletennis"},{value:"讀書",url:"https://i.imgur.com/jneYUkV.jpg",category:"study"},{value:"讀書會",url:"https://i.imgur.com/rM3O9xh.png",category:"studyclub"},{value:"看比賽",url:"https://i.imgur.com/Yya0Www.png",category:"race"}];return{imageList:e,rooms:[],userRooms:[],dialogFormVisible:!1,dialogFormRoom:"",formLabelWidth:"120px",roomTypeDict:[],sideBarList:[],category:["吃飯","團購","遊戲","聊天","共乘","交易","分組","出遊"],user:{nickname:""}}},computed:Object(b["a"])(Object(b["a"])({},Object(x["b"])(["isAuth"])),{},{filteredRooms:function(){var e=this;return this.$store.state.filter?this.rooms.filter((function(t){return t.room_category.includes(e.$store.state.filter)||t.introduction.includes(e.$store.state.filter)||t.title.includes(e.$store.state.filter)})):this.rooms}}),created:function(){var e=this;this.$store.state.token&&!this.$store.state.is_verify&&this.$store.dispatch("getIsVerify").then((function(){0==e.$store.state.is_verify&&(e.$router.push({name:"profile"}),e.$message.error("未過 mail 認證 !"))})),this.$store.state.token?this.$store.dispatch("refreshToken").then((function(t){console.log("token:",t.data,"\nstart to get some list:"),V["a"].getRooms().then((function(t){e.rooms=t.data})).catch((function(e){console.log("getRooms err :",e)})),e.$store.dispatch("getUserId").then((function(){return V["a"].getUserDetail(e.$store.state.user_id)})).then((function(t){e.user=t.data})).catch((function(e){console.log("getRooms err :",e)})),V["a"].getRoomCategory().then((function(t){console.log("[Warning]: 目前有成功拿到資料但是沒有寫入",t.data),e.sideBarList=e.imageList.map((function(e){return e.value}))})).catch((function(e){console.log("getRoomCategory err :",e)})),V["a"].getRoomType().then((function(t){e.roomTypeDict=t.data})).catch((function(e){console.log("getRoomType err :",e)})),V["a"].getUserRooms().then((function(t){e.userRooms=t.data})).catch((function(e){console.log(e)})),e.$emit("wsConnStart",!0)})).catch((function(t){console.log("[Home.vue.created.catch], token exist but:","\nstatus code: ",t.response.status,"\nerror message: ",JSON.stringify(t.response.data)),"code"in t.response.data&&"token_not_valid"==t.response.data["code"]&&(console.log("[Home.vue.created.catch] delete token"),e.$store.dispatch("resetToken")),e.$router.push({name:"login"})})):(console.log("plz login !"),this.$message.error("請登入 !"),this.$router.push({name:"login"}))},methods:{joinRoom:function(){var e=this;console.log("exec join room"),this.$store.state.token&&this.$store.dispatch("refreshToken",this.event).then((function(t){return console.log(t.data.access),V["a"].postJoinRoom(e.dialogFormRoom.id,e.user.nickname)})).then((function(t){console.log("[Success]: 已加入房間",t.data),e.$router.push({name:"room-show",params:{id:e.dialogFormRoom.id}})})).catch((function(t){var o=t.data["error"];"You are already in the room."==o&&e.$router.push({name:"room-show",params:{id:e.dialogFormRoom.id}}),e.$message.error(t.data["error"])}))},updateFilter:function(e){this.filter=e},updateClickedRoom:function(e){var t=this.userRooms.map((function(e){return e.id}));t.includes(e["clickedRoomId"])?this.$router.push({name:"room-show",params:{id:e["clickedRoomId"]}}):(this.dialogFormVisible=e["dialogFormVisible"],this.dialogFormRoom=e["dialogFormRoom"])}}};o("f4d2");$.render=d,$.__scopeId="data-v-139dc7c4";var M=$,C=(o("a4d3"),o("e01a"),Object(r["fb"])("data-v-5f43c837"));Object(r["G"])("data-v-5f43c837");var I=Object(r["l"])("點我登入"),L=Object(r["m"])("h1",null,"Create an Room",-1),S=Object(r["l"])("-"),D=Object(r["m"])("span",null,"簡介",-1),T=Object(r["l"])("Create Room"),U=Object(r["l"])("Cancel");Object(r["E"])();var F=C((function(e,t,o,n,i,a){var c=Object(r["M"])("el-link"),l=Object(r["M"])("el-alert"),s=Object(r["M"])("el-input"),u=Object(r["M"])("el-form-item"),m=Object(r["M"])("el-option"),d=Object(r["M"])("el-select"),b=Object(r["M"])("el-date-picker"),f=Object(r["M"])("el-col"),p=Object(r["M"])("el-time-picker"),g=Object(r["M"])("el-radio"),h=Object(r["M"])("el-radio-group"),j=Object(r["M"])("el-slider"),O=Object(r["M"])("el-autocomplete"),v=Object(r["M"])("el-button"),_=Object(r["M"])("el-form"),y=Object(r["M"])("el-container");return Object(r["D"])(),Object(r["i"])("div",null,[Object(r["m"])(y,{class:"create-form"},{default:C((function(){return[Object(r["m"])(_,{ref:"form",model:i.room,"label-width":"80px",onSubmit:t[12]||(t[12]=Object(r["eb"])((function(){}),["prevent"]))},{default:C((function(){return[e.isAuth?Object(r["j"])("",!0):(Object(r["D"])(),Object(r["i"])(l,{key:0,title:"您尚未登入，登入後才能建立房間。",type:"warning","show-icon":""},{default:C((function(){return[Object(r["m"])(c,{href:"/login",type:"primary"},{default:C((function(){return[I]})),_:1})]})),_:1})),L,Object(r["m"])(u,{prop:"title",label:"房間標題",rules:i.notNullrule},{default:C((function(){return[Object(r["m"])(s,{modelValue:i.room.title,"onUpdate:modelValue":t[1]||(t[1]=function(e){return i.room.title=e}),placeholder:"請填入房間標題"},null,8,["modelValue"])]})),_:1},8,["rules"]),Object(r["m"])(u,{label:"您的暱稱",prop:"nickname",rules:i.notNullrule},{default:C((function(){return[Object(r["m"])(s,{modelValue:i.room.nickname,"onUpdate:modelValue":t[2]||(t[2]=function(e){return i.room.nickname=e}),placeholder:"請填入暱稱"},null,8,["modelValue"])]})),_:1},8,["rules"]),Object(r["m"])(u,{label:"房間分類",prop:"category",rules:i.notNullrule},{default:C((function(){return[Object(r["m"])(d,{modelValue:i.room.category,"onUpdate:modelValue":t[3]||(t[3]=function(e){return i.room.category=e}),placeholder:"choose category",onChange:i.renderUrl},{default:C((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(i.imageList,(function(e){return Object(r["D"])(),Object(r["i"])(m,{label:e.value,key:e.category,value:e.category},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"])]})),_:1},8,["rules"]),Object(r["m"])(u,{label:"關房時間"},{default:C((function(){return[Object(r["m"])(f,{span:11},{default:C((function(){return[Object(r["m"])(b,{type:"date",placeholder:"Choose Date",modelValue:i.room.date1,"onUpdate:modelValue":t[4]||(t[4]=function(e){return i.room.date1=e}),style:{width:"100%"}},null,8,["modelValue"])]})),_:1}),Object(r["m"])(f,{class:"line",span:2},{default:C((function(){return[S]})),_:1}),Object(r["m"])(f,{span:11},{default:C((function(){return[Object(r["m"])(p,{placeholder:"Choose Time",modelValue:i.room.date2,"onUpdate:modelValue":t[5]||(t[5]=function(e){return i.room.date2=e}),style:{width:"100%"}},null,8,["modelValue"])]})),_:1})]})),_:1}),Object(r["m"])(u,{label:"房間類型"},{default:C((function(){return[Object(r["m"])(h,{modelValue:i.room.type,"onUpdate:modelValue":t[6]||(t[6]=function(e){return i.room.type=e})},{default:C((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(i.roomTypeDict,(function(e,t){return Object(r["D"])(),Object(r["i"])(g,{label:t,key:t},{default:C((function(){return[Object(r["l"])(Object(r["Q"])(e),1)]})),_:2},1032,["label"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(r["m"])(u,{label:"最大人數",onSubmit:t[8]||(t[8]=Object(r["eb"])((function(){}),["prevent"]))},{default:C((function(){return[Object(r["m"])(j,{modelValue:i.room.capacity,"onUpdate:modelValue":t[7]||(t[7]=function(e){return i.room.capacity=e}),"show-input":"",max:100,step:5},null,8,["modelValue"])]})),_:1}),Object(r["m"])(u,{prop:"description",rules:i.notNullrule},{label:C((function(){return[D]})),default:C((function(){return[Object(r["m"])(s,{type:"textarea",placeholder:"Enter description of your room:",modelValue:i.room.description,"onUpdate:modelValue":t[9]||(t[9]=function(e){return i.room.description=e}),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]})),_:1},8,["rules"]),Object(r["m"])(u,{label:"封面照片"},{default:C((function(){return[Object(r["m"])(O,{class:"inline-input",modelValue:i.selectedImageCate,"onUpdate:modelValue":t[10]||(t[10]=function(e){return i.selectedImageCate=e}),"fetch-suggestions":i.querySearch,placeholder:"請輸入內容",onSelect:i.handleSelect},null,8,["modelValue","fetch-suggestions","onSelect"]),Object(r["m"])(s,{modelValue:i.room.image_url,"onUpdate:modelValue":t[11]||(t[11]=function(e){return i.room.image_url=e}),placeholder:"可放可不放，建議上傳 imgur 並複製圖片網址(.jpg 或 .png 結尾)",clearable:""},null,8,["modelValue"])]})),_:1}),Object(r["m"])(u,null,{default:C((function(){return[Object(r["m"])(v,{type:"primary",onClick:a.createRoom,loading:i.loading},{default:C((function(){return[T]})),_:1},8,["onClick","loading"]),Object(r["m"])(v,null,{default:C((function(){return[U]})),_:1})]})),_:1})]})),_:1},8,["model"])]})),_:1})])})),E=o("3835"),P=(o("b64b"),o("4fad"),{components:null,data:function(){var e=this,t={course:"課程討論",find_group:"尋求組隊"},o={public:"公開",private:"私人",lesson:"課程"},n=[{value:"自定義",url:"",category:""},{value:"課程討論",url:"https://i.imgur.com/GIiSOLM.jpg",category:"course"},{value:"吃飯",url:"https://i.imgur.com/kN4J0UL.jpg",category:"eating"},{value:"爬山",url:"https://i.imgur.com/17SSeJb.png",category:"hiking"},{value:"打籃球",url:"https://i.imgur.com/o2uS5WX.png",category:"baseketball"},{value:"打 Apex",url:"https://i.imgur.com/PkZu9rV.jpg",category:"apex"},{value:"玩 Switch 遊戲",url:"https://i.imgur.com/16C4zzd.png",category:"switch"},{value:"跑步",url:"https://i.imgur.com/wc0HqRT.png",category:"running"},{value:"團購",url:"https://i.imgur.com/hcP3JA2.png",category:"group_buying"},{value:"逛街",url:"https://i.imgur.com/85zF3RK.jpg",category:"shopping"},{value:"打遊戲",url:"https://i.imgur.com/ex5uIMF.jpg",category:"game"},{value:"買衣服",url:"https://i.imgur.com/UElotjt.jpg",category:"clothing"},{value:"麥當勞",url:"https://i.imgur.com/Ll9w1eq.png",category:"mc"},{value:"肯德基",url:"https://i.imgur.com/NBt3Xka.jpg",category:"kfc"},{value:"看電影",url:"https://i.imgur.com/QzZKggo.png",category:"moive"},{value:"演唱會",url:"https://i.imgur.com/NBt3Xka.jpg",category:"live"},{value:"打桌球",url:"https://i.imgur.com/kluQV3e.jpg",category:"tabletennis"},{value:"讀書",url:"https://i.imgur.com/jneYUkV.jpg",category:"study"},{value:"讀書會",url:"https://i.imgur.com/rM3O9xh.png",category:"studyclub"},{value:"看比賽",url:"https://i.imgur.com/Yya0Www.png",category:"race"}],r=function(e,t){var o=e?n.filter(i(e)):n;console.log("results:",o),t(o)},i=function(e){return function(t){return 0===t.value.toLowerCase().indexOf(e.toLowerCase())}},a=function(t){e.room.image_url=t.url},c=function(t){var o=e.imageList.find((function(e){return e.category==t}));o&&(e.room.image_url=o.url,e.selectedImageCate=o.value)};return{categoryDict:t,roomTypeDict:o,imageList:n,querySearch:r,createFilter:i,handleSelect:a,renderUrl:c,loading:!1,selectedImageCate:"",notNullrule:{required:!0,message:"不能為空",trigger:"blur"},room:{title:"",nickname:"房主",capacity:10,category:"",date1:new Date,date2:new Date((new Date).setHours(23,59,59)),invite:!1,tag:[],type:"public",description:"",image_url:""}}},created:function(){var e=this;this.$store.state.token||(console.log("plz login !"),this.$router.push({name:"login"})),this.$store.state.token&&!this.$store.state.is_verify&&this.$store.dispatch("getIsVerify").then((function(){0==e.$store.state.is_verify&&(e.$router.push({name:"profile"}),e.$message.error("未過 mail 認證 !"))}))},methods:{hardcreateRoom:function(){var e=this;this.$store.state.token?this.$store.dispatch("refreshToken").then((function(t){return console.log("resRefresh token:",t.data),e.loading=!0,V["a"].postRoom(e.room)})).then((function(t){201==t.status&&console.log(t.statusText),e.$message.success(t.statusText),e.loading=!1})).catch((function(t){console.log("[Warning ! 401 401 401 !]"),e.loading=!1,console.log("[RoomCreate.vue.created.catch], token exist but:","\nstatus code: ",t.response.status,"\nerror message: ",JSON.stringify(t.response.data)),"code"in t.response.data&&"token_not_valid"==t.response.data["code"]&&(console.log("[RoomCreate.vue.createRoom.catch] delete token"),e.$store.dispatch("resetToken"),e.$router.push({name:"login"})),e.$message.error(JSON.stringify(t.response.data))})):(console.log("plz login !"),this.$router.push({name:"login"}))},createRoom:function(){var e=this;if(this.$store.state.token)return this.$store.dispatch("refreshToken").then((function(t){return 200!=t.status?Promise.reject("refresh token err"):(e.loading=!0,V["a"].postRoom(e.room))})).then((function(t){console.log("res in CreateRoom:",t),e.$message.success(t.statusText),e.loading=!1,e.$router.push({name:"room-show",params:{id:t.data.id}})})).catch((function(t){console.log("err in CreateRoom:",t.data,Object.keys(t.data));for(var o=0,n=Object.entries(t.data);o<n.length;o++){var r=Object(E["a"])(n[o],2),i=r[0],a=r[1];e.$message.error(i+": "+a[0])}e.loading=!1}));console.log("plz login !"),this.$router.push({name:"login"})}},computed:Object(b["a"])({},Object(x["b"])(["isAuth"]))});o("469f");P.render=F,P.__scopeId="data-v-5f43c837";var B=P,W=Object(r["fb"])("data-v-4f684388");Object(r["G"])("data-v-4f684388");var N={class:"title"},A=Object(r["m"])("h5",null,"房主",-1),Q=Object(r["m"])("h5",null,"房間開放時間",-1),q=Object(r["m"])("br",null,null,-1),K=Object(r["l"])(" 房間簡介"),z=Object(r["m"])("h5",null,"分類",-1),J=Object(r["l"])(" 成員列表"),G={class:"username"},Y=Object(r["l"])(" 限制人數 "),H=Object(r["m"])("h5",null,"測試 input",-1),X=Object(r["m"])("h5",null,"離開房間",-1),Z=Object(r["l"])("離開房間"),ee=Object(r["m"])("span",null,"最大人數",-1),te={class:"dialog-footer"},oe=Object(r["l"])("取消"),ne=Object(r["l"])("送出"),re=Object(r["m"])("h3",null,"成員列表",-1),ie=Object(r["l"])("踢出房間"),ae=Object(r["l"])("封鎖"),ce=Object(r["l"])("將房主轉移給他"),le=Object(r["m"])("h3",null,"Block 列表",-1),se=Object(r["l"])("解除封鎖"),ue=Object(r["m"])("h3",null,"邀請列表",-1),me=Object(r["l"])("邀請"),de={class:"dialog-footer"},be=Object(r["l"])("關閉"),fe=Object(r["m"])("h3",null,"Room Record",-1),pe=Object(r["m"])("br",null,null,-1);Object(r["E"])();var ge=W((function(e,t,o,n,i,a){var c=Object(r["M"])("SideBar"),l=Object(r["M"])("el-aside"),s=Object(r["M"])("ChatRoom"),u=Object(r["M"])("el-main"),m=Object(r["M"])("el-divider"),d=Object(r["M"])("el-button"),b=Object(r["M"])("el-avatar"),f=Object(r["M"])("el-input"),p=Object(r["M"])("el-popconfirm"),g=Object(r["M"])("el-scrollbar"),h=Object(r["M"])("el-container"),j=Object(r["M"])("el-form-item"),O=Object(r["M"])("el-option"),v=Object(r["M"])("el-select"),_=Object(r["M"])("el-slider"),y=Object(r["M"])("el-form"),k=Object(r["M"])("el-dialog"),w=Object(r["M"])("el-table-column"),R=Object(r["M"])("el-table");return Object(r["D"])(),Object(r["i"])(r["b"],null,[Object(r["m"])(h,{class:"mainContainer"},{default:W((function(){return[Object(r["m"])(l,{class:"SideBarContainer"},{default:W((function(){return[Object(r["m"])(c,{sideBarList:i.userRooms.map((function(e){return{text:e.title,url:"/room/"+e.id+"/"}})),urlMode:!0},null,8,["sideBarList"])]})),_:1}),Object(r["m"])(u,{class:"chatRoomContainer"},{default:W((function(){return[Object(r["m"])(s,{roomws:i.roomws,messages:i.messages,onAddMessage:a.addMessage},null,8,["roomws","messages","onAddMessage"])]})),_:1}),Object(r["m"])(l,{class:"roomInfo"},{default:W((function(){return[Object(r["m"])(g,null,{default:W((function(){return[Object(r["m"])("h5",N,Object(r["Q"])(i.room.title),1),Object(r["m"])(m),Object(r["m"])("div",null,[A,Object(r["m"])("p",null,Object(r["Q"])(i.host?i.host:""),1)]),Object(r["m"])(m),Object(r["m"])("div",null,[Q,Object(r["m"])("p",null,[Object(r["l"])(Object(r["Q"])(i.room.create_time?i.room.create_time.slice(0,10):"未指定")+" "+Object(r["Q"])(i.room.create_time?i.room.create_time.slice(11,19):"")+" ~",1),q,Object(r["l"])(" "+Object(r["Q"])(i.room.valid_time?i.room.valid_time.slice(0,10):"未指定")+" "+Object(r["Q"])(i.room.valid_time?i.room.valid_time.slice(11,19):""),1)])]),Object(r["m"])(m),Object(r["m"])("div",null,[Object(r["m"])("h5",null,[K,Object(r["m"])("i",{class:"el-icon-edit el-input__icon",onClick:t[1]||(t[1]=function(e){return i.dialogFormVisible=!0})})]),Object(r["m"])("p",null,Object(r["Q"])(i.room.introduction),1)]),Object(r["m"])(m),Object(r["m"])("div",null,[z,Object(r["m"])(d,{size:"mini",round:""},{default:W((function(){return[Object(r["l"])(Object(r["Q"])(i.room.room_category),1)]})),_:1})]),Object(r["m"])(m),Object(r["m"])("div",null,[Object(r["m"])("h5",null,[J,Object(r["m"])("i",{class:"el-icon-edit el-input__icon",onClick:t[2]||(t[2]=function(e){return i.memberFormVisible=!0})})]),(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(i.memberList,(function(e){return Object(r["D"])(),Object(r["i"])("div",{class:"member",key:e.member_id},[Object(r["m"])(b,{size:"small",icon:"el-icon-user-solid"}),Object(r["m"])("p",G,Object(r["Q"])(e.nickname),1)])})),128))]),Object(r["m"])(m),Object(r["m"])("div",null,[Object(r["m"])("h5",null,[Y,Object(r["m"])("i",{class:"el-icon-edit el-input__icon",onClick:t[3]||(t[3]=function(){return e.handleIconClick&&e.handleIconClick.apply(e,arguments)})})]),Object(r["m"])("p",null,Object(r["Q"])("lesson"==i.room.room_type?"無限制":i.room.people_limit),1)]),Object(r["m"])(m),Object(r["m"])("div",null,[H,Object(r["m"])(f,{placeholder:"請輸入內容",clearable:""},{suffix:W((function(){return[Object(r["m"])("i",{class:"el-icon-edit el-input__icon",onClick:t[4]||(t[4]=function(){return e.handleIconClick&&e.handleIconClick.apply(e,arguments)})})]})),_:1})]),Object(r["m"])(m),Object(r["m"])("div",null,[X,Object(r["m"])(p,{confirmButtonText:"離開",confirmButtonType:"danger",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"確定離開 ? 離開後將不會是成員。若您是房主會直接刪除房間。",onConfirm:a.handleExitRoom},{reference:W((function(){return[Object(r["m"])(d,{type:"danger",round:""},{default:W((function(){return[Z]})),_:1})]})),_:1},8,["onConfirm"])])]})),_:1})]})),_:1})]})),_:1}),i.isAdmin?(Object(r["D"])(),Object(r["i"])(k,{key:0,title:"編輯房間",modelValue:i.dialogFormVisible,"onUpdate:modelValue":t[12]||(t[12]=function(e){return i.dialogFormVisible=e})},{footer:W((function(){return[Object(r["m"])("span",te,[Object(r["m"])(d,{onClick:t[10]||(t[10]=function(e){return i.dialogFormVisible=!1})},{default:W((function(){return[oe]})),_:1}),Object(r["m"])(d,{type:"primary",onClick:t[11]||(t[11]=function(e){a.handleEditRoom(),i.dialogFormVisible=!1})},{default:W((function(){return[ne]})),_:1})])]})),default:W((function(){return[Object(r["m"])(y,{model:i.dialogFormRoom},{default:W((function(){return[Object(r["m"])(j,{label:"房間名稱"},{default:W((function(){return[Object(r["m"])(f,{modelValue:i.dialogFormRoom.title,"onUpdate:modelValue":t[5]||(t[5]=function(e){return i.dialogFormRoom.title=e})},null,8,["modelValue"])]})),_:1}),Object(r["m"])(j,{label:"房間 Category"},{default:W((function(){return[Object(r["m"])(v,{modelValue:i.dialogFormRoom.room_category,"onUpdate:modelValue":t[6]||(t[6]=function(e){return i.dialogFormRoom.room_category=e}),placeholder:"選擇房間分類"},{default:W((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(i.categoryDict,(function(e,t){return Object(r["D"])(),Object(r["i"])(O,{label:e,key:e,value:t},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),Object(r["m"])(j,{label:"簡介"},{default:W((function(){return[Object(r["m"])(f,{type:"textarea",placeholder:"Enter description of your room:",modelValue:i.dialogFormRoom.introduction,"onUpdate:modelValue":t[7]||(t[7]=function(e){return i.dialogFormRoom.introduction=e}),maxlength:"100","show-word-limit":""},null,8,["modelValue"])]})),_:1}),Object(r["m"])(j,{onSubmit:t[9]||(t[9]=Object(r["eb"])((function(){}),["prevent"]))},{default:W((function(){return[ee,Object(r["m"])(_,{modelValue:i.dialogFormRoom.people_limit,"onUpdate:modelValue":t[8]||(t[8]=function(e){return i.dialogFormRoom.people_limit=e}),"show-input":"",max:100,step:5,"input-size":"mini"},null,8,["modelValue"])]})),_:1})]})),_:1},8,["model"])]})),_:1},8,["modelValue"])):Object(r["j"])("",!0),Object(r["m"])(k,{modelValue:i.memberFormVisible,"onUpdate:modelValue":t[16]||(t[16]=function(e){return i.memberFormVisible=e})},{footer:W((function(){return[Object(r["m"])("span",de,[Object(r["m"])(d,{type:"primary",onClick:t[15]||(t[15]=function(e){return i.memberFormVisible=!1})},{default:W((function(){return[be]})),_:1})])]})),default:W((function(){return[re,Object(r["m"])(R,{data:i.memberList,style:{width:"100%"}},{default:W((function(){return[Object(r["m"])(w,{type:"expand"},{default:W((function(e){return[Object(r["m"])(y,{"label-position":"left",inline:"",class:"demo-table-expand"},{default:W((function(){return[Object(r["m"])(j,{label:"學號"},{default:W((function(){return[Object(r["m"])("span",null,Object(r["Q"])(e.row.username),1)]})),_:2},1024),Object(r["m"])(j,{label:"暱稱"},{default:W((function(){return[Object(r["m"])("span",null,Object(r["Q"])(e.row.nickname),1)]})),_:2},1024),i.isAdmin&&i.user.member_id!=e.row.member_id?(Object(r["D"])(),Object(r["i"])(j,{key:0,label:"操作"},{default:W((function(){return[Object(r["m"])(d,{size:"mini",type:"warning",plain:"",onClick:function(t){return a.handleMemberOperation(e.$index,e.row,"remove")}},{default:W((function(){return[ie]})),_:2},1032,["onClick"]),Object(r["m"])(d,{size:"mini",type:"danger",onClick:function(t){return a.handleMemberOperation(e.$index,e.row,"block")}},{default:W((function(){return[ae]})),_:2},1032,["onClick"]),Object(r["m"])(p,{confirmButtonText:"確認",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"確定轉移房主身分給他 ? 您將降級為無權限用戶。",onConfirm:function(t){return a.handleTransferAdmin(e.row)}},{reference:W((function(){return[Object(r["m"])(d,{size:"mini",type:"danger",plain:""},{default:W((function(){return[ce]})),_:1})]})),_:2},1032,["onConfirm"])]})),_:2},1024)):Object(r["j"])("",!0),i.isAdmin&&i.user.member_id!=e.row.member_id?(Object(r["D"])(),Object(r["i"])(j,{key:1,label:"更改階級成:"},{default:W((function(){return[Object(r["m"])(v,{modelValue:i.tmp,"onUpdate:modelValue":t[13]||(t[13]=function(e){return i.tmp=e}),onChange:function(t){return a.handleSetLevel(t,e.row.member_id)}},{default:W((function(){return[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(i.levelDict,(function(e,t){return Object(r["D"])(),Object(r["i"])(O,{key:t,label:e,value:t},null,8,["label","value"])})),128))]})),_:2},1032,["modelValue","onChange"])]})),_:2},1024)):Object(r["j"])("",!0)]})),_:2},1024)]})),_:1}),Object(r["m"])(w,{label:"學號",prop:"username"}),Object(r["m"])(w,{label:"暱稱",prop:"nickname"}),Object(r["m"])(w,{label:"階級",prop:"access_level"})]})),_:1},8,["data"]),le,Object(r["m"])(R,{data:i.blockList,style:{width:"100%"}},{default:W((function(){return[Object(r["m"])(w,{type:"expand"},{default:W((function(e){return[Object(r["m"])(y,{"label-position":"left",inline:"",class:"demo-table-expand"},{default:W((function(){return[Object(r["m"])(j,{label:"操作者"},{default:W((function(){return[Object(r["m"])("span",null,Object(r["Q"])(i.memberList.filter((function(t){return t.member_id==e.row.block_manager_id}))[0].nickname+"("+e.row.block_manager_id+")"),1)]})),_:2},1024),i.isAdmin?(Object(r["D"])(),Object(r["i"])(j,{key:0,label:"操作"},{default:W((function(){return[Object(r["m"])(p,{confirmButtonText:"確認",cancelButtonText:"取消",icon:"el-icon-info",iconColor:"red",title:"確定解除封鎖 ?",onConfirm:function(t){return a.handleUnblockOperation(e.row)}},{reference:W((function(){return[Object(r["m"])(d,{size:"mini",type:"danger"},{default:W((function(){return[se]})),_:1})]})),_:2},1032,["onConfirm"])]})),_:2},1024)):Object(r["j"])("",!0)]})),_:2},1024)]})),_:1}),Object(r["m"])(w,{prop:"blocked_user_id",label:"學號"}),Object(r["m"])(w,{prop:"reason",label:"原因"})]})),_:1},8,["data"]),ue,Object(r["m"])(y,{inline:!0,class:"demo-form-inline"},{default:W((function(){return[Object(r["m"])(j,{label:"請輸入欲邀請學號"},{default:W((function(){return[Object(r["m"])(f,{modelValue:i.invitedUserId,"onUpdate:modelValue":t[14]||(t[14]=function(e){return i.invitedUserId=e}),placeholder:"學號"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(j,null,{default:W((function(){return[Object(r["m"])(d,{type:"primary",onClick:a.handleInvitation},{default:W((function(){return[me]})),_:1},8,["onClick"])]})),_:1})]})),_:1}),Object(r["m"])(R,{data:i.invitationList,style:{width:"100%"}},{default:W((function(){return[Object(r["m"])(w,{prop:"invited_username",label:"被邀請者"}),Object(r["m"])(w,{prop:"inviter_username",label:"邀請者"})]})),_:1},8,["data"]),fe,Object(r["m"])("div",null,[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(i.roomRecord.slice(i.roomRecord.length-5,i.roomRecord.length),(function(e){return Object(r["D"])(),Object(r["i"])("span",{key:e},[Object(r["l"])(Object(r["Q"])(e.recording),1),pe])})),128))])]})),_:1},8,["modelValue"])],64)})),he=o("ade3"),je=o("1da1"),Oe=(o("96cf"),o("a9e3"),o("4d90"),o("99af"),{class:"messagesWrapper"}),ve={class:"inlineContainer own"},_e=Object(r["m"])("img",{class:"inlineIcon",src:"https://www.pinclipart.com/picdir/middle/205-2059398_blinkk-en-mac-app-store-ninja-icon-transparent.png"},null,-1),ye={class:"ownBubble own"},ke={class:"own"},we={class:"inlineContainer"},Re=Object(r["m"])("img",{class:"inlineIcon",src:"https://cdn1.iconfinder.com/data/icons/ninja-things-1/1772/ninja-simple-512.png"},null,-1),Ve={class:"otherBubble other"},xe={class:"other"};function $e(e,t,o,n,i,a){var c=Object(r["M"])("el-scrollbar"),l=Object(r["M"])("el-input");return Object(r["D"])(),Object(r["i"])(r["b"],null,[Object(r["m"])(c,{class:"messageWrapperScrollBar"},{default:Object(r["bb"])((function(){return[Object(r["m"])("div",Oe,[(Object(r["D"])(!0),Object(r["i"])(r["b"],null,Object(r["K"])(o.messages,(function(e,t){return Object(r["D"])(),Object(r["i"])("div",{key:t,class:"bubbleWrapper",ref:"messageRef"},[e.user===a.myID?(Object(r["D"])(),Object(r["i"])(r["b"],{key:0},[Object(r["m"])("div",ve,[_e,Object(r["m"])("div",ye,Object(r["Q"])(e.text),1)]),Object(r["m"])("span",ke,Object(r["Q"])(e.time),1)],64)):(Object(r["D"])(),Object(r["i"])(r["b"],{key:1},[Object(r["m"])("div",we,[Re,Object(r["m"])("div",Ve,Object(r["Q"])(e.text),1)]),Object(r["m"])("span",xe,Object(r["Q"])(e.time),1)],64))],512)})),128))])]})),_:1}),Object(r["m"])(l,{placeholder:"輸入訊息",modelValue:i.message,"onUpdate:modelValue":t[1]||(t[1]=function(e){return i.message=e}),onKeydown:a.addMessage,class:"messageInput"},null,8,["modelValue","onKeydown"])],64)}var Me={props:["roomws","messages"],computed:{myID:function(){return this.$store.state.user_id}},data:function(){return{message:"",sendMessage:""}},methods:{addMessage:function(e){if("Enter"===e.key&&this.message){var t=new Date,o=t.getHours(),n=t.getMinutes();o=String(o).padStart(2,"0"),n=String(n).padStart(2,"0");var r="".concat(o,":").concat(n),i={user:this.$store.state.user_id,text:this.message,time:r};this.$emit("addMessasge",i);var a=parseInt(this.$route.params.id,10);console.log(this.$store.state.user_id);var c={header:"message",msg_type:"text",userID:this.$store.state.user_id,roomID:a,message:this.message,token:this.$store.state.token};this.roomws[a].send(JSON.stringify(c)),this.message=""}}},watch:{messages:{immediate:!0,deep:!0,handler:function(){this.$nextTick((function(){var e=this.$refs.messageRef;e&&e.scrollIntoView(!1,{behavior:"smooth"})}))}}}};o("1334");Me.render=$e;var Ce=Me,Ie=o("32b9"),Le={props:["id"],components:{SideBar:R,ChatRoom:Ce},data:function(){return{exist_btn_text:"離開房間",tmp:"",invitedUserId:"",user:{access_level:"user"},memberList:[],invitationList:[],blockList:[],categoryDict:{},userRooms:[],levelDict:{admin:"房主",manager:"房管",user:"普通用戶"},host:"",roomRecord:"",dialogFormVisible:!1,isAdmin:!1,room:{id:0,title:"Loading Not Successful",introduction:"Loading Not Successful",create_time:"2000-01-01T20:33:33.033448+08:00",valid_time:"2000-01-01T20:33:33.033448+08:00",room_type:"private",room_category:"course",people_limit:1},tableData:[{date:"2010-01-01",name:"",address:""}],dialogFormRoom:{},memberFormVisible:!1,roomws:{},messages:[]}},created:function(){var e=this;return Object(je["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.state.token&&!e.$store.state.is_verify&&e.$store.dispatch("getIsVerify").then((function(){console.log("未過 mail 認證 !"),0==e.$store.state.is_verify&&(e.$router.push({name:"profile"}),e.$message.error("未過 mail 認證 !"))})),e.$store.state.token?e.$store.dispatch("refreshToken").then((function(t){return console.log(t),e.getUserRooms()})).then((function(t){return t.data.map((function(e){return e.id})).includes(Number(e.id))?(e.userRooms=t.data,e.init_list()):(e.$message.error("你怎麼進來的 = ="),Promise.reject("user not in room !"))})).catch((function(e){console.log(e)})):(e.$message.error("請登入 !"),e.$router.push({name:"login"})),null==e.$store.state.roomWebsocketConn[e.$route.params.id]&&(console.log("this.$store.state.roomWebsocketConn[this.$route.params.id] == null"),e.roomws[e.$route.params.id]=Ie["a"].InitRoomWebsocket(e.$store.state.token,e.$route.params.id),o=e.$route.params.id,console.log(e.roomws[o]),e.roomws[o].onmessage=function(t){console.log(t.data);var o=JSON.parse(t.data),n=null;switch(o.header){case"message":n=new Date(o.time);var r=n.getHours(),i=n.getMinutes();r=String(r).padStart(2,"0"),i=String(i).padStart(2,"0");var a="".concat(r,":").concat(i),c={user:o.userID,text:o.message,time:a};e.messages.push(c);break;case"update":console.log(o.roomID),console.log(o.message),console.log(o.time);break;case"ping":break}});case 3:case"end":return t.stop()}}),t)})))()},methods:{init_list:function(){var e=this;this.getRoomObj().then((function(t){e.room=t,e.dialogFormRoom=Object(b["a"])({},t),console.log(t)})).catch((function(e){console.log(e)})),this.getInvitationList().then((function(t){e.invitationList=t.data,console.log("invitationList",t.data)})).catch((function(e){console.log(e.data)})),this.getMemberList().then((function(t){return e.memberList=t.data,e.host=t.data.filter((function(e){return"admin"==e.access_level}))[0].nickname,console.log("memberList: ",t.data),e.getUserObj()})).catch((function(e){console.log(e.data)})),this.getBlockList().then((function(t){e.blockList=t.data,console.log("blockList:",t.data)})).catch((function(e){console.log(e.data)})),this.getInvitationList().then((function(t){e.invitationList=t.data,console.log("invitationList:",t.data)})).catch((function(e){console.log(e.data)})),this.getRoomRecord().then((function(t){e.roomRecord=t.data,console.log("roomRecord:",t.data)})).catch((function(e){console.log(e.data)})),this.getRoomCategory().then((function(t){e.categoryDict=t.data,console.log("categoryDict:",t.data)})).catch((function(e){console.log(e.data)}))},getUserObj:function(){var e=this;V["a"].getUserId().then((function(t){var o=t.data.id,n=e.memberList.filter((function(e){return e.member_id==o}))[0];n&&(e.user=n)})).catch((function(e){return Promise.reject(e)}))},getRoomObj:function(){var e=this;return new Promise((function(t,o){V["a"].getRoom(e.id).then((function(e){t(e.data)})).catch((function(e){console.log("There was an error:",JSON.stringify(e.response)),o(e.data)}))}))},getMemberList:function(){return V["a"].getRoomMemberList(this.id)},getBlockList:function(){return V["a"].getRoomBlockList(this.id)},getInvitationList:function(){return V["a"].getRoomInvitationList(this.id)},getRoomRecord:function(){return V["a"].getRoomRecord(this.id)},getRoomCategory:function(){return V["a"].getRoomCategory()},getUserRooms:function(){return V["a"].getUserRooms()},handleEditRoom:function(){var e=this;V["a"].putRoom(this.id,this.dialogFormRoom).then((function(t){console.log("[Success] 成功修改房間，成果:",t.data),e.room=t.data})).catch((function(e){console.log(e)}))},handleExitRoom:function(){var e=this;"admin"==this.user.access_level?V["a"].deleteRoom(this.id).catch((function(t){e.$message.error(t.data.error)})):V["a"].deleteLeaveRoom(this.id).catch((function(t){e.$message.error(t.data.error)})),this.$router.push({name:"home"})},handleInvitation:function(){var e=this;V["a"].postRoomInvite(this.id,this.invitedUserId).then((function(){return console.log("postRoomInvite Successful"),e.getInvitationList()})).then((function(t){e.invitationList=t.data})).catch((function(t){e.$message.error(t.data.error)}))},handleCancelInvitation:function(e){console.log(e.invited_id)},handleSetLevel:function(e,t){var o=this;V["a"].putSetLevel(this.id,Object(he["a"])({},t,e)).then((function(){return console.log("suc"),o.getMemberList()})).then((function(n){o.memberList=n.data,console.log("[Success]",t,"的階級改成",e),o.$message.success("修改階級成功 !")})).catch((function(e){o.$message.error("handleSetLevel:",e.data.error)}))},handleAddModerator:function(e){var t={};t[e.member_id]="",console.log(t)},handleTransferAdmin:function(e){var t=this;V["a"].putTransferAdmin(this.id,e.member_id).then((function(){return t.getBlockList()})).catch((function(e){console.log(e)}))},handleUnblockOperation:function(e){var t=this;V["a"].deleteUnblockUser(this.id,e.blocked_user_id).then((function(){console.log("[Success] 解除封鎖成功，對象:",e.blocked_user_id),t.blockList=t.blockList.filter((function(t){return t.blocked_user_id!=e.blocked_user_id}))})).catch((function(e){console.log(e)}))},handleMemberOperation:function(e,t,o){var n=this,r="block"==o?"封鎖":"踢出房間";this.$prompt("執行原因","將 "+t.nickname+" 踢出房間"+r,{confirmButtonText:"確定",cancelButtonText:"取消",inputPattern:/[^(?!\s*$).+]/,inputErrorMessage:"原因不能為空 !"}).then((function(e){return"block"==o?V["a"].postBlockUser(n.id,t.member_id,e.value):"remove"==o?V["a"].deleteRemoveUser(n.id,t.member_id,e.value):void 0})).then((function(e){if(200==e.status&&n.$message({type:"success",message:r+"成功"}),n.memberList=n.memberList.filter((function(e){return e.member_id!=t.member_id})),"block"==o)return n.getBlockList()})).then((function(e){n.blockList=e.data})).catch((function(e){console.log("[In RoomShow]",e),"cancel"==e&&n.$message({type:"info",message:"取消操作"})})),console.log("[Success]: 執行",o,"操作成功，對象:",t.member_id)},addMessage:function(e){this.messages.push(e)}},watch:{memberList:function(e){this.getUserObj(),console.log("[watch] memberList changed:",e)},user:function(e){this.isAdmin="admin"==e.access_level||"moderator"==e.access_level}}};o("77ed");Le.render=ge,Le.__scopeId="data-v-4f684388";var Se=Le,De=Object(r["fb"])("data-v-19c24d53");Object(r["G"])("data-v-19c24d53");var Te={class:"login"},Ue=Object(r["m"])("h2",null,"Login",-1),Fe=Object(r["l"])("Login"),Ee=Object(r["m"])("a",{class:"forgot-password",href:""},"Forgot password ?",-1);Object(r["E"])();var Pe=De((function(e,t,o,n,i,a){var c=Object(r["M"])("el-input"),l=Object(r["M"])("el-form-item"),s=Object(r["M"])("el-button"),u=Object(r["M"])("el-form"),m=Object(r["M"])("el-card");return Object(r["D"])(),Object(r["i"])("div",Te,[Object(r["m"])(m,{class:"login-card"},{default:De((function(){return[Ue,Object(r["m"])(u,{class:"login-form",model:i.model,rules:i.rules,ref:"form",onSubmit:Object(r["eb"])(a.login,["prevent"])},{default:De((function(){return[Object(r["m"])(l,{prop:"email"},{default:De((function(){return[Object(r["m"])(c,{modelValue:i.model.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return i.model.email=e}),placeholder:"Email","prefix-icon":"el-icon-user"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,{prop:"password"},{default:De((function(){return[Object(r["m"])(c,{modelValue:i.model.password,"onUpdate:modelValue":t[2]||(t[2]=function(e){return i.model.password=e}),placeholder:"Password",type:"password","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,null,{default:De((function(){return[Object(r["m"])(s,{loading:i.loading,class:"login-button",type:"primary","native-type":"submit",block:""},{default:De((function(){return[Fe]})),_:1},8,["loading"])]})),_:1}),Ee]})),_:1},8,["model","rules","onSubmit"])]})),_:1}),Object(r["cb"])(Object(r["m"])("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=function(e){return i.ttoo=e})},null,512),[[r["X"],i.ttoo]]),Object(r["m"])("button",{onClick:t[4]||(t[4]=function(){return a.pu&&a.pu.apply(a,arguments)})},"pu")])})),Be={data:function(){return{model:{email:"",password:""},ttoo:"",loading:!1,rules:{email:[{required:!0,message:"Email is required",trigger:"blur"},{min:4,message:"Email length should be at least 4 characters",trigger:"blur"}],password:[{required:!0,message:"Password is required",trigger:"blur"},{min:4,message:"Password length should be at least 5 characters",trigger:"blur"}]}}},created:function(){this.forDev()},methods:{pu:function(){localStorage.setItem("token",this.ttoo),console.log(this.ttoo)},forDev:function(){this.model.email="test1@test.com",this.model.password="test1"},Login:function(){var e=this;this.$store.dispatch("login",this.model).then((function(){e.$message.success("Login successfull"),e.$router.go(-1)})).catch((function(t){console.log("Login Failed:",t),e.$message.error("Email or password is invalid")}))},simulateLogin:function(){return new Promise((function(e){setTimeout(e,800)}))},login:function(){var e=this;return Object(je["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate();case 2:if(o=t.sent,o){t.next=5;break}return t.abrupt("return");case 5:return e.loading=!0,t.next=8,e.Login();case 8:e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()}}};o("bec4");Be.render=Pe,Be.__scopeId="data-v-19c24d53";var We=Be,Ne=Object(r["fb"])("data-v-196d86f1");Object(r["G"])("data-v-196d86f1");var Ae=Object(r["m"])("h1",null,"Create an Room",-1),Qe=Object(r["l"])("Create Room"),qe=Object(r["l"])("Cancel");Object(r["E"])();var Ke=Ne((function(e,t,o,n,i,a){var c=Object(r["M"])("el-input"),l=Object(r["M"])("el-form-item"),s=Object(r["M"])("el-button"),u=Object(r["M"])("el-form"),m=Object(r["M"])("el-container");return Object(r["D"])(),Object(r["i"])("div",null,[Object(r["m"])("h2",null,"您的 User ID: "+Object(r["Q"])(i.id),1),Object(r["m"])(m,{class:"create-form"},{default:Ne((function(){return[Object(r["m"])(u,{ref:"form",model:i.room,"label-width":"80px"},{default:Ne((function(){return[Ae,Object(r["m"])(l,{label:"Title"},{default:Ne((function(){return[Object(r["m"])(c,{modelValue:i.room.title,"onUpdate:modelValue":t[1]||(t[1]=function(e){return i.room.title=e})},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,null,{default:Ne((function(){return[Object(r["m"])(s,{type:"primary",onClick:a.createEvent},{default:Ne((function(){return[Qe]})),_:1},8,["onClick"]),Object(r["m"])(s,null,{default:Ne((function(){return[qe]})),_:1})]})),_:1})]})),_:1},8,["model"])]})),_:1})])})),ze={components:null,data:function(){return{room:{organizer:"1",capacity:0,title:"2",region:"3",date1:"4",date2:"5",invite:!1,tag:[],type:"6",description:"7"},id:""}},created:function(){var e=this;V["a"].getUserId().then((function(t){e.id=t.data.id})).catch((function(e){console.log("[err in user]",e)}))},methods:{checkAuth:function(){var e=this;this.$store.state.token&&this.$store.dispatch("verifyToken",this.event).then((function(t){return console.log("verifyToken Result："+t),e.init()})).catch((function(e){console.log("[RoomCreate.vue]",e),window.location.href="/login"}))},init:function(){console.log("exec init")},createEvent:function(){var e=this;this.$store.dispatch("createEvent",this.event).then((function(){e.$router.push({name:"event-show",params:{id:e.event.id}}),e.event=e.createFreshEventObject()})).catch((function(){console.log("There was a problem creating your event")}))},createFreshRoomObject:function(){var e=this.$store.state.user;return{user:e,department:"",organizer:e,title:"",description:"",capacity:10,type:"public"}}},computed:Object(b["a"])({},Object(x["b"])(["isAuth"]))};o("4b43");ze.render=Ke,ze.__scopeId="data-v-196d86f1";var Je=ze,Ge=Object(r["fb"])("data-v-51d37446");Object(r["G"])("data-v-51d37446");var Ye={class:"resetPWD"},He=Object(r["m"])("h2",null,"重設密碼",-1),Xe=Object(r["l"])("提交");Object(r["E"])();var Ze=Ge((function(e,t,o,n,i,a){var c=Object(r["M"])("el-input"),l=Object(r["M"])("el-form-item"),s=Object(r["M"])("el-button"),u=Object(r["M"])("el-form"),m=Object(r["M"])("el-card");return Object(r["D"])(),Object(r["i"])("div",Ye,[Object(r["m"])(m,{class:"reset-card"},{default:Ge((function(){return[He,Object(r["m"])(u,{class:"reset-form",model:i.model,rules:i.rules,ref:"form",onSubmit:Object(r["eb"])(a.submit,["prevent"])},{default:Ge((function(){return[Object(r["m"])(l,{prop:"password",label:"新密碼"},{default:Ge((function(){return[Object(r["m"])(c,{modelValue:i.model.password,"onUpdate:modelValue":t[1]||(t[1]=function(e){return i.model.password=e}),placeholder:"Input password",type:"password","prefix-icon":"fas fa-lock"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,{prop:"repeatPassword",label:"再輸入一次"},{default:Ge((function(){return[Object(r["m"])(c,{modelValue:i.model.repeatPassword,"onUpdate:modelValue":t[2]||(t[2]=function(e){return i.model.repeatPassword=e}),placeholder:"Input password again",type:"password","prefix-icon":"fas fa-repeat"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,null,{default:Ge((function(){return[Object(r["m"])(s,{loading:i.loading,class:"login-button",type:"primary","native-type":"submit",block:""},{default:Ge((function(){return[Xe]})),_:1},8,["loading"])]})),_:1})]})),_:1},8,["model","rules","onSubmit"])]})),_:1})])})),et={props:["userToken","mailToken"],data:function(){var e=this,t=function(t,o,n){o!==e.model.password?n(new Error("兩次輸入密碼不一致 !")):n()};return{loading:!1,model:{password:"",repeatPassword:""},rules:{password:[{required:!0,message:"Password is required",trigger:"blur"},{min:4,message:"Password length should be at least 4 characters",trigger:"blur"}],repeatPassword:[{required:!0,message:"Password is required",trigger:"blur"},{min:4,message:"Password length should be at least 4 characters",trigger:"blur"},{validator:t,trigger:"blur"}]}}},created:function(){this.forDev()},methods:{forDev:function(){this.model.password="test",this.model.repeatPassword="test"},submitReset:function(){return console.log("submitReset"),V["a"].postResetPassword(this.userToken,this.mailToken,this.model.password)},simulateLogin:function(){return new Promise((function(e){setTimeout(e,800)}))},submit:function(){var e=this;return Object(je["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate();case 2:if(o=t.sent,o){t.next=5;break}return t.abrupt("return");case 5:return e.loading=!0,t.next=8,e.submitReset().then((function(t){e.$message.success("修改成功 !"),console.log(t),e.$router.push({name:"login"})})).catch((function(t){e.$message.error("有些問題發生了 ! 請聯繫管理員 QQ"),console.log(t)}));case 8:e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()}}};o("73eb");et.render=Ze,et.__scopeId="data-v-51d37446";var tt=et,ot=Object(r["fb"])("data-v-2a49a6ef");Object(r["G"])("data-v-2a49a6ef");var nt={class:"cr-container"},rt=Object(r["m"])("div",{class:"mars"},null,-1),it={key:0,src:"https://assets.codepen.io/1538474/404.svg",class:"logo-404"},at=Object(r["m"])("img",{src:"https://assets.codepen.io/1538474/meteor.svg",class:"meteor"},null,-1),ct={class:"title"},lt={class:"subtitle"},st=Object(r["m"])("div",{align:"center"},[Object(r["m"])("a",{class:"btn-back",href:"/"},"Back to home page")],-1),ut=Object(r["m"])("img",{src:"https://assets.codepen.io/1538474/astronaut.svg",class:"astronaut"},null,-1),mt=Object(r["m"])("img",{src:"https://assets.codepen.io/1538474/spaceship.svg",class:"spaceship"},null,-1);Object(r["E"])();var dt=ot((function(e,t,o,n,i,a){return Object(r["D"])(),Object(r["i"])("div",nt,[rt,"404"==o.type?(Object(r["D"])(),Object(r["i"])("img",it)):Object(r["j"])("",!0),at,Object(r["m"])("p",ct,Object(r["Q"])(i.title),1),Object(r["m"])("p",lt,Object(r["Q"])(i.description),1),st,ut,mt])})),bt={props:["type","token","userToken"],data:function(){return{title:"Oh no!!",description:"You’re either misspelling the URL \n or requesting a page that's no longer here."}},created:function(){this.init()},methods:{init:function(){var e=this;"verify-mail"==this.type?(this.title="Mail Verification",V["a"].getMailVerify(this.userToken,this.token).then((function(t){"success"==t.data?e.description="Verify Successful !":console.log(t.data)})).catch((function(t){e.description=t.data}))):"permission-deny"==this.type&&(this.title="Permission Deny",this.description="可能是因為您不是該房間成員、或是已被封鎖 \n 故無法進入該房間 !")}}};o("8bd8");bt.render=dt,bt.__scopeId="data-v-2a49a6ef";var ft=bt,pt=Object(r["fb"])("data-v-9ec4355a");Object(r["G"])("data-v-9ec4355a");var gt={class:"register"},ht=Object(r["m"])("h2",null,"註冊",-1),jt=Object(r["m"])("span",null,"@ntu.edu.tw",-1),Ot=Object(r["l"])("提交");Object(r["E"])();var vt=pt((function(e,t,o,n,i,a){var c=Object(r["M"])("el-input"),l=Object(r["M"])("el-col"),s=Object(r["M"])("el-form-item"),u=Object(r["M"])("el-button"),m=Object(r["M"])("el-form"),d=Object(r["M"])("el-card");return Object(r["D"])(),Object(r["i"])("div",gt,[Object(r["m"])(d,{class:"register-card"},{default:pt((function(){return[ht,Object(r["m"])(m,{class:"register-form",model:i.model,rules:i.rules,ref:"form",onSubmit:Object(r["eb"])(a.register,["prevent"])},{default:pt((function(){return[Object(r["m"])(s,{label:"E-mail (* 僅可用 ntu.edu.tw 註冊，填學號)",prop:"email"},{default:pt((function(){return[Object(r["m"])(l,{span:12},{default:pt((function(){return[Object(r["m"])(c,{modelValue:i.model.email,"onUpdate:modelValue":t[1]||(t[1]=function(e){return i.model.email=e}),placeholder:"Email","prefix-icon":"el-icon-user"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(l,{span:7},{default:pt((function(){return[jt]})),_:1})]})),_:1}),Object(r["m"])(s,{label:"密碼",prop:"password"},{default:pt((function(){return[Object(r["m"])(c,{modelValue:i.model.password,"onUpdate:modelValue":t[2]||(t[2]=function(e){return i.model.password=e}),placeholder:"請輸入密碼",type:"password","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(s,{label:"請再輸入一次密碼",prop:"password2"},{default:pt((function(){return[Object(r["m"])(c,{modelValue:i.model.password2,"onUpdate:modelValue":t[3]||(t[3]=function(e){return i.model.password2=e}),placeholder:"再輸入一次密碼",type:"password","prefix-icon":"el-icon-lock"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(s,{label:"姓名",required:""},{default:pt((function(){return[Object(r["m"])(l,{span:8},{default:pt((function(){return[Object(r["m"])(s,{prop:"last_name"},{default:pt((function(){return[Object(r["m"])(c,{"prefix-icon":"el-icon-user",modelValue:i.model.last_name,"onUpdate:modelValue":t[4]||(t[4]=function(e){return i.model.last_name=e}),placeholder:"姓"},null,8,["modelValue"])]})),_:1})]})),_:1}),Object(r["m"])(l,{span:8},{default:pt((function(){return[Object(r["m"])(s,{prop:"first_name"},{default:pt((function(){return[Object(r["m"])(c,{modelValue:i.model.first_name,"onUpdate:modelValue":t[5]||(t[5]=function(e){return i.model.first_name=e}),placeholder:"名"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),Object(r["m"])(s,{label:"系籍",prop:"department",required:""},{default:pt((function(){return[Object(r["m"])(c,{modelValue:i.model.department,"onUpdate:modelValue":t[6]||(t[6]=function(e){return i.model.department=e}),placeholder:"系籍","prefix-icon":"el-icon-folder"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(s,{label:"暱稱",prop:"nickname",required:""},{default:pt((function(){return[Object(r["m"])(c,{modelValue:i.model.nickname,"onUpdate:modelValue":t[7]||(t[7]=function(e){return i.model.nickname=e}),placeholder:"Nickname","prefix-icon":"el-icon-chat-round"},null,8,["modelValue"])]})),_:1}),Object(r["m"])(s,null,{default:pt((function(){return[Object(r["m"])(u,{loading:i.loading,class:"register-button",type:"primary","native-type":"submit",block:""},{default:pt((function(){return[Ot]})),_:1},8,["loading"])]})),_:1})]})),_:1},8,["model","rules","onSubmit"])]})),_:1})])})),_t={data:function(){var e=this,t=function(t,o,n){o!==e.model.password?n(new Error("兩次輸入密碼不一致 !")):n()};return{model:{email:"",password:"",password2:"",last_name:"",first_name:"",department:"",nickname:""},loading:!1,rules:{email:[{required:!0,message:"必須填寫(寫學號就好)",trigger:"blur"},{min:4,message:"Email length should be at least 4 characters",trigger:"blur"}],password:[{required:!0,message:"必須填寫",trigger:"blur"},{min:4,message:"請設定至少四個字以上",trigger:"blur"}],password2:[{required:!0,message:"必須填寫",trigger:"blur"},{min:4,message:"請設定至少四個字以上",trigger:"blur"},{validator:t,trigger:"blur"}],last_name:[{required:!0,message:"姓 必須填寫",trigger:"blur"}],first_name:[{required:!0,message:"名 必須填寫",trigger:"blur"}],department:[{required:!0,message:"系籍必須填寫",trigger:"blur"}],nickname:[{required:!0,message:"暱稱必須填寫",trigger:"blur"}]}}},created:function(){this.forDev()},methods:{forDev:function(){this.model.email="r09921119",this.model.password="test",this.model.password2="test",this.model.last_name="許",this.model.first_name="凱荃",this.model.department="電機系",this.model.nickname="MeteorV"},submitRegister:function(){console.log("submitRegister");var e=Object.assign({},this.model);return e.email=e.email+"@ntu.edu.tw",V["a"].postRegister(e)},simulateLogin:function(){return new Promise((function(e){setTimeout(e,800)}))},register:function(){var e=this;return Object(je["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.validate();case 2:if(o=t.sent,o){t.next=5;break}return t.abrupt("return");case 5:return e.loading=!0,t.next=8,e.submitRegister().then((function(t){e.$message.success("註冊成功 ! 記得去信箱收信 !"),console.log(t),e.$router.push({name:"login"})})).catch((function(t){for(var o=0,n=Object.entries(t.data);o<n.length;o++){var r=Object(E["a"])(n[o],2),i=r[0],a=r[1];e.$message.error(i+": "+a[0]),console.log(i+": "+a[0])}}));case 8:e.loading=!1;case 9:case"end":return t.stop()}}),t)})))()}}};o("77b6");_t.render=vt,_t.__scopeId="data-v-9ec4355a";var yt=_t,kt=[{path:"/",name:"home",component:M},{path:"/room/create",name:"room-create",component:B},{path:"/room/:id",name:"room-show",component:Se,props:!0},{path:"/about",name:"about",component:function(){return o.e("about").then(o.bind(null,"f820"))}},{path:"/login",name:"login",component:We},{path:"/register",name:"register",component:yt},{path:"/forgetpwd/:userToken/:mailToken",name:"mail-verify",component:tt,props:!0},{path:"/profile",name:"profile",component:Je},{path:"/:type",name:"unknow-redirect",component:ft,props:!0},{path:"/:type/:userToken/:token",name:"verify-mail",component:ft,props:!0}],wt=Object(n["a"])({history:Object(n["b"])("/"),routes:kt});t["a"]=wt},acb1:function(e,t,o){"use strict";o("f2f6")},bec4:function(e,t,o){"use strict";o("e6b9")},cbd3:function(e,t,o){},cea6:function(e,t,o){},cf76:function(e,t,o){"use strict";o("e5df")},e5df:function(e,t,o){},e6b9:function(e,t,o){},ef13:function(e,t){function o(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id="ef13"},f2f6:function(e,t,o){},f4d2:function(e,t,o){"use strict";o("cbd3")}});
//# sourceMappingURL=app.681f1e0d.js.map